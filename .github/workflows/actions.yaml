name: DataflowEXP_Workflow
on:
  push:
    branches:
    - 'feature/poc_dfexp'
    #- '!development'
    #- '!release/**'
    # - '!master'
    #- '!hotfix/**'
  pull_request:
    branches:
    - 'poc_dfexp'
   # - 'development'
   # - 'release/**'
   # - 'master'
   # - 'hotfix/**'
    types: 
    - closed
    
    jobs:
      checkout_job:
      runs-on: ubuntu-latest
      defaults:
        run:
        shell: bash
      steps:
      - name: Checkout code
        uses: actions/checkout@v2
        
      check_job:
       needs: job1
       runs-on: ubuntu-latest
       strategy:
        matrix: 
          directory: [dataflow/templates]
       steps:
       - name: Checkout code
         uses: actions/checkout@v2
         with:
           fetch-depth: 2
           
       - name: Detect file diff
      run: |
        echo "Listing modified files from the last commit:"
        git diff HEAD~1 --name-only --diff-filter=MA --output=diff.txt dataflow/templates/
        cat diff.txt
        
        - name: Dataflow working 
        run: |
        BRANCH=${GITHUB_REF#refs/heads/}
        echo "$BRANCH"
        if [[ $BRANCH == poc_dfexp ]]; then
          ENV=exp
        elif [[ $BRANCH == development ]]; then
          ENV=dev
        elif [[ $BRANCH == master ]]; then
          ENV=prod
        fi

       
     
  
